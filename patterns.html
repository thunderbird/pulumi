<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html"><link rel="search" title="Search" href="search.html"><link rel="next" title="Monitoring Resources" href="monitors.html"><link rel="prev" title="Getting Started" href="getting-started.html">

    <!-- Generated with Sphinx 9.1.0 and Furo 2025.12.19 -->
        <title>Patterns of Use - tb_pulumi documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=7bdb33bb" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">tb_pulumi  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <span class="sidebar-brand-text">tb_pulumi  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting Started</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Patterns of Use</a></li>
<li class="toctree-l1"><a class="reference internal" href="monitors.html">Monitoring Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Development</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="modules.html">tb_pulumi</a><input aria-label="Toggle navigation of tb_pulumi" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="tb_pulumi.html">tb_pulumi</a></li>
<li class="toctree-l2"><a class="reference internal" href="autoscale.html">tb_pulumi.autoscale</a></li>
<li class="toctree-l2"><a class="reference internal" href="ci.html">tb_pulumi.ci</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloudfront.html">tb_pulumi.cloudfront</a></li>
<li class="toctree-l2"><a class="reference internal" href="cloudwatch.html">tb_pulumi.cloudwatch</a></li>
<li class="toctree-l2"><a class="reference internal" href="constants.html">tb_pulumi.constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="ec2.html">tb_pulumi.ec2</a></li>
<li class="toctree-l2"><a class="reference internal" href="elasticache.html">tb_pulumi.elasticache</a></li>
<li class="toctree-l2"><a class="reference internal" href="fargate.html">tb_pulumi.fargate</a></li>
<li class="toctree-l2"><a class="reference internal" href="iam.html">tb_pulumi.iam</a></li>
<li class="toctree-l2"><a class="reference internal" href="monitoring.html">tb_pulumi.monitoring</a></li>
<li class="toctree-l2"><a class="reference internal" href="network.html">tb_pulumi.network</a></li>
<li class="toctree-l2"><a class="reference internal" href="rds.html">tb_pulumi.rds</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3.html">tb_pulumi.s3</a></li>
<li class="toctree-l2"><a class="reference internal" href="secrets.html">tb_pulumi.secrets</a></li>
<li class="toctree-l2"><a class="reference internal" href="guardduty.html">tb_pulumi.guardduty</a></li>
<li class="toctree-l2"><a class="reference internal" href="securityhub.html">tb_pulumi.securityhub</a></li>
<li class="toctree-l2"><a class="reference internal" href="cfg.html">tb_pulumi.cfg</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/patterns.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="patterns-of-use">
<span id="id1"></span><h1>Patterns of Use<a class="headerlink" href="#patterns-of-use" title="Link to this heading">¶</a></h1>
<p>The patterns contained in this module support our use cases for services hosted by Thunderbird Pro Services. To
summarize a bit from the <a class="reference internal" href="getting-started.html#getting-started"><span class="std std-ref">Getting Started</span></a> page:</p>
<ul class="simple">
<li><p>We extend the <code class="docutils literal notranslate"><span class="pre">pulumi.ComponentResource</span></code> class into a <code class="docutils literal notranslate"><span class="pre">tb_pulumi.ThunderbirdComponentResource</span></code> class, which
exposes the resources contained within it to higher-order code.</p></li>
<li><p>These are organized into <code class="docutils literal notranslate"><span class="pre">tb_pulumi.ThunderbirdPulumiProject</span></code> s, which connect YAML configuration files to Pulumi
code files and provide programmatic access to all components within it.</p></li>
</ul>
<p>This page explains these conventions in clearer detail and describes the common code patterns that follow from adhering
to them.</p>
<section id="patterns-for-managing-projects">
<h2>Patterns for Managing Projects<a class="headerlink" href="#patterns-for-managing-projects" title="Link to this heading">¶</a></h2>
<p>One primary goal of this project is to reduce most infrastructural changes to YAML file tweaks once the initial setup is
done, requiring no code inspection or debugging for most common changes. The
<a class="reference internal" href="tb_pulumi.html#tb_pulumi.ThunderbirdPulumiProject" title="tb_pulumi.ThunderbirdPulumiProject"><code class="xref py py-class docutils literal notranslate"><span class="pre">tb_pulumi.ThunderbirdPulumiProject</span></code></a> class brings those configs, information about the cloud environment, and
Pulumi project and stack data into a single context. That context is then made available to any
<a class="reference internal" href="tb_pulumi.html#tb_pulumi.ThunderbirdComponentResource" title="tb_pulumi.ThunderbirdComponentResource"><code class="xref py py-class docutils literal notranslate"><span class="pre">tb_pulumi.ThunderbirdComponentResource</span></code></a> created within that project.</p>
<p>Given that you have…</p>
<ul class="simple">
<li><p>created a Pulumi stack with a <code class="docutils literal notranslate"><span class="pre">$STACK_NAME</span></code>,</p></li>
<li><p>properly written a <code class="docutils literal notranslate"><span class="pre">config.$STACK_NAME.yaml</span></code> file alongside your tb_pulumi code, and</p></li>
<li><p>configured your AWS client,</p></li>
</ul>
<p>…the following code will produce a ThunderbirdPulumiProject with all context availablle for the currently selected
stack:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">tb_pulumi</span>
<span class="n">project</span> <span class="o">=</span> <span class="n">tb_pulumi</span><span class="o">.</span><span class="n">ThunderbirdPulumiProject</span><span class="p">()</span>
</pre></div>
</div>
<p>For example, you can now get the <code class="docutils literal notranslate"><span class="pre">resources</span></code> mapping from your configuration like so:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">resources</span> <span class="o">=</span> <span class="n">project</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;resources&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>At this point, if you have not defined a <code class="docutils literal notranslate"><span class="pre">resources</span></code> section in your config file, <code class="docutils literal notranslate"><span class="pre">resources</span></code> will be <code class="docutils literal notranslate"><span class="pre">None</span></code>. But
if you have a good config, it will be a dict where the top-level keys are Pulumi type strings.</p>
<p>You could, of course, do this as well:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">resources</span> <span class="o">=</span> <span class="n">project</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;resources&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>But in the case where the config file is not set up right, this results in a <code class="docutils literal notranslate"><span class="pre">KeyError</span></code>. This is fine, and you should
raise an exception in this case anyway. We find the <code class="docutils literal notranslate"><span class="pre">.get()</span></code> method is more elegant.</p>
<p>Consider this approach instead:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">resources</span> <span class="o">=</span> <span class="n">project</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;resources&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">resources</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;tb_pulumi is not configured for stack </span><span class="si">{</span><span class="n">project</span><span class="o">.</span><span class="n">stack</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Also consider the case where you need access to a nested option. The</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># This prints a big stack trace ending in a KeyError</span>
<span class="n">child_config</span> <span class="o">=</span> <span class="n">resources</span><span class="p">[</span><span class="s1">&#39;parent_config&#39;</span><span class="p">][</span><span class="s1">&#39;child_config&#39;</span><span class="p">]</span>

<span class="c1"># If you want to emit a custom error</span>
<span class="k">try</span><span class="p">:</span>
  <span class="n">child_config</span> <span class="o">=</span> <span class="n">resources</span><span class="p">[</span><span class="s1">&#39;parent_config&#39;</span><span class="p">][</span><span class="s1">&#39;child_config&#39;</span><span class="p">]</span>
<span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
  <span class="n">pulumi</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;No child config&#39;</span><span class="p">)</span>

  <span class="c1"># You can either hard sys.exit</span>
  <span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
  <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

  <span class="c1"># Or re-raise the exception</span>
  <span class="k">raise</span> <span class="n">ex</span>

<span class="c1"># But in this form, child_config gets None, allowing us to gracefully handle the failure</span>
<span class="c1"># with little code and extra output.</span>
<span class="n">child_config</span> <span class="o">=</span> <span class="n">resources</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;parent_config&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;child_config&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">child_config</span><span class="p">:</span>
  <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No child config&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="resource-patterns">
<h2>Resource Patterns<a class="headerlink" href="#resource-patterns" title="Link to this heading">¶</a></h2>
<section id="define-a-resource-with-no-dependencies">
<h3>Define a resource with no dependencies<a class="headerlink" href="#define-a-resource-with-no-dependencies" title="Link to this heading">¶</a></h3>
<p>The simplest resources stand alone, depending on no other resources, only a valid configuration. Even simpler is when
you must create only one. Consider this YAML config and Python definition of a <code class="docutils literal notranslate"><span class="pre">MultiCidrVpc</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="nt">resources</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tb:network:MultiCidrVpc</span><span class="p">:</span>
<span class="w">    </span><span class="nt">vpc</span><span class="p">:</span>
<span class="w">      </span><span class="nt">cidr_block</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.0.0.0/16</span>
<span class="w">      </span><span class="nt">subnets</span><span class="p">:</span>
<span class="w">        </span><span class="nt">eu-central-1a</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.0.0.0/17</span>
<span class="w">        </span><span class="nt">eu-central-1b</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.0.128.0/17</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">vpc_opts</span> <span class="o">=</span> <span class="n">resources</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tb:network:MultiCidrVpc&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;vpc&#39;</span><span class="p">)</span>
<span class="n">vpc</span> <span class="o">=</span> <span class="n">tb_pulumi</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">MultiCidrVpc</span><span class="p">(</span>
  <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">project</span><span class="o">.</span><span class="n">name_prefix</span><span class="si">}</span><span class="s1">-vpc&#39;</span><span class="p">,</span>
  <span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">,</span>
  <span class="o">**</span><span class="n">vpc_opts</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This provides only the bare minimum of code-based information:</p>
<blockquote>
<div><ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">name</span></code> of the resource, making use of the project’s <code class="docutils literal notranslate"><span class="pre">name_prefix</span></code> to create a unique identifier.</p></li>
<li><p>The project we have defined, so this resource and the other resources it contains can be traversed.</p></li>
</ul>
</div></blockquote>
<p>After that, it simply expands the <code class="docutils literal notranslate"><span class="pre">vpc_opts</span></code> (which has been ripped straight from the config file) into function
parameters. In this way, any changes you make to your YAML will be read into the VPC resource.</p>
</section>
<section id="access-a-resource-from-within-a-thunderbirdcomponentresource">
<h3>Access a resource from within a ThunderbirdComponentResource<a class="headerlink" href="#access-a-resource-from-within-a-thunderbirdcomponentresource" title="Link to this heading">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">ThunderbirdPulumiProject</span></code> and a <code class="docutils literal notranslate"><span class="pre">ThunderbirdComponentResource</span></code> each have a <code class="docutils literal notranslate"><span class="pre">resources</span></code> member which is a
dict of all components defined within it. At both levels, these can be Pulumi Outputs, Resources, ComponentResources,
ThunderbirdComponentResources, or a collection of any of these things. Documentation for each
ThunderbirdComponentResource describes what resources it contains. In a project, the keys in this dict are named after
whatever names you provide for the ThunderbirdComponentResources. In a ThunderbirdComponentResource, they’re named
according to what that resource is labeled in its <code class="xref py py-meth docutils literal notranslate"><span class="pre">tb_pulumi.ThunderbirdPulumiProject.finish()</span></code> call. All of the
various resources created by our classes are fully documented in the <a class="reference internal" href="modules.html#modules"><span class="std std-ref">tb_pulumi</span></a> page.</p>
<p>One common need is to define a <code class="docutils literal notranslate"><span class="pre">MultiCidrVpc</span></code> and then feed one of the subnet IDs to an EC2 instance. If we have
defined the <code class="docutils literal notranslate"><span class="pre">vpc</span></code> resource as in the sample in the previous section, we can access the subnet IDs from the variable
itself. <a class="reference internal" href="network.html#tb_pulumi.network.MultiCidrVpc" title="tb_pulumi.network.MultiCidrVpc"><code class="xref py py-class docutils literal notranslate"><span class="pre">tb_pulumi.network.MultiCidrVpc</span></code></a> documentation shows that the <code class="docutils literal notranslate"><span class="pre">aws.ec2.Subnet</span></code> resources are
available through the <code class="docutils literal notranslate"><span class="pre">subnets</span></code> resource. Here are some things you can do with that:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get a list of all subnet resources</span>
<span class="n">subnets</span> <span class="o">=</span> <span class="n">vpc</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;subnets&#39;</span><span class="p">)</span>

<span class="c1"># Get a list of all subnet IDs</span>
<span class="n">subnet_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">subnet</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">subnet</span> <span class="ow">in</span> <span class="n">vpc</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;subnets&#39;</span><span class="p">)]</span>

<span class="c1"># Get the first subnet ID</span>
<span class="n">subnet_id</span> <span class="o">=</span> <span class="n">vpc</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;subnets&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>Remember that this value will be a <code class="docutils literal notranslate"><span class="pre">pulumi.Output</span></code> , not a real subnet ID, not until Pulumi has applied the resource.
For the most part, this is okay. You could pass that value into some other resource as an Output, and Pulumi would wait
for a real value before proceeding.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">subnet_id</span> <span class="o">=</span> <span class="n">vpc</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;subnets&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">instance_opts</span> <span class="o">=</span> <span class="n">resources</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tb:ec2:SshableInstance&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;my-instance&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">instance_opts</span><span class="p">:</span>
  <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;my-instance not configured&#39;</span><span class="p">)</span>

<span class="n">instance</span> <span class="o">=</span> <span class="n">tb_pulumi</span><span class="o">.</span><span class="n">ec2</span><span class="o">.</span><span class="n">SshableInstance</span><span class="p">(</span>
  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;my-instance&#39;</span><span class="p">,</span>
  <span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">,</span>
  <span class="n">subnet_id</span><span class="o">=</span><span class="n">subnet_id</span><span class="p">,</span>
  <span class="o">**</span><span class="n">instance_opts</span><span class="p">,</span>
  <span class="n">opts</span><span class="o">=</span><span class="n">pulumi</span><span class="o">.</span><span class="n">ResourceOptions</span><span class="p">(</span><span class="n">depends_on</span><span class="o">=</span><span class="p">[</span><span class="n">vpc</span><span class="p">]),</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Note that in this pattern, we only hardcode parameters whose values are generated elsewhere in the code. As many options
as possible are passed in directly from the YAML file.</p>
<p>Also note the addition of the <code class="docutils literal notranslate"><span class="pre">opts</span></code> parameter, which specifies that the instance is dependent on the VPC resources.
This helps Pulumi set up its dependency tree and prevent problems where you try to build resources that need access to
IDs that don’t exist yet.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This also showcases an important concept. Pulumi’s internal dependency tree is built around <code class="docutils literal notranslate"><span class="pre">Resource</span></code> objects. You
are defining a <code class="docutils literal notranslate"><span class="pre">Resource</span></code> which depends on another <code class="docutils literal notranslate"><span class="pre">Resource</span></code>. This relationship in Pulumi causes it to wait for
the first <code class="docutils literal notranslate"><span class="pre">Resource</span></code> to be fully applied before trying to apply the dependent one.</p>
<p>A Pulumi <code class="docutils literal notranslate"><span class="pre">ComponentResource</span></code> is a collection of <code class="docutils literal notranslate"><span class="pre">Resource</span></code> s, but it is actually an extension of the <code class="docutils literal notranslate"><span class="pre">Resource</span></code>
class. So Pulumi understands this as a type of resource upon which some other resource can be dependent.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">ThunderbirdComponentResource</span></code> is an extension of the <code class="docutils literal notranslate"><span class="pre">ComponentResource</span></code> class, meaning that <strong>even our custom
resource collection type can be used as a collective dependency.</strong> In the above example, the entire <code class="docutils literal notranslate"><span class="pre">MultiCidrVpc</span></code>
and every resource it contains will be applied before the <code class="docutils literal notranslate"><span class="pre">SshableInstance</span></code> ever gets underway.</p>
</div>
<p>If you need to wait on that value so you can form it as text, you must write an <code class="docutils literal notranslate"><span class="pre">apply</span></code> lambda:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="c1"># ... project setup, etc ...</span>

<span class="n">subnet_id</span> <span class="o">=</span> <span class="n">vpc</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;subnets&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">json_text</span> <span class="o">=</span> <span class="n">subnet_id</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">subnet_id</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span><span class="s1">&#39;subnet_id&#39;</span><span class="p">:</span> <span class="n">subnet_id</span><span class="p">}))</span>
</pre></div>
</div>
</section>
<section id="defining-multiple-resources-of-the-same-type">
<h3>Defining multiple resources of the same type<a class="headerlink" href="#defining-multiple-resources-of-the-same-type" title="Link to this heading">¶</a></h3>
<p>So far, we have defined singular resources based on singular definitions in the YAML config. Suppose we have a case
where we might want to build more resources of the same type without adjusting code. In this case, we might want some
YAML that looks like this:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="nt">resources</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tb:network:SecurityGroupWithRules</span><span class="p">:</span>
<span class="w">    </span><span class="nt">backend-database</span><span class="p">:</span>
<span class="w">      </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">        </span><span class="nt">ingress</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Let traffic into the DB from our IP range</span>
<span class="w">            </span><span class="nt">cidr_blocks</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.0.0.0/8</span>
<span class="w">            </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tcp</span>
<span class="w">            </span><span class="nt">from_port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5432</span>
<span class="w">            </span><span class="nt">to_port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5432</span>
<span class="w">        </span><span class="nt">egress</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Let the DB talk out</span>
<span class="w">            </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tcp</span>
<span class="w">            </span><span class="nt">from_port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">            </span><span class="nt">to_port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">65535</span>
<span class="w">            </span><span class="nt">cidr_blocks</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0.0.0/0</span>
<span class="w">    </span><span class="nt">backend-api-lb</span><span class="p">:</span>
<span class="w">      </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">        </span><span class="nt">ingress</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Let traffic into the API service from anywhere</span>
<span class="w">            </span><span class="nt">cidr_blocks</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0.0.0/0</span>
<span class="w">            </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tcp</span>
<span class="w">            </span><span class="nt">from_port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443</span>
<span class="w">            </span><span class="nt">to_port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443</span>
<span class="w">        </span><span class="nt">egress</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Let the LB talk out</span>
<span class="w">            </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tcp</span>
<span class="w">            </span><span class="nt">from_port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">            </span><span class="nt">to_port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">65535</span>
<span class="w">            </span><span class="nt">cidr_blocks</span><span class="p">:</span>
</pre></div>
</div>
<p>We do not have to explicitly define both of these security groups. We can feed the data in via dict comprehension:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sgs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">sg_name</span><span class="p">:</span> <span class="n">tb_pulumi</span><span class="o">.</span><span class="n">network</span><span class="o">.</span><span class="n">SecurityGroupWithRules</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">project</span><span class="o">.</span><span class="n">name_prefix</span><span class="si">}</span><span class="s1">-sg-</span><span class="si">{</span><span class="n">sg_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
        <span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">,</span>
        <span class="n">vpc_id</span><span class="o">=</span><span class="n">vpc</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;vpc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">opts</span><span class="o">=</span><span class="n">pulumi</span><span class="o">.</span><span class="n">ResourceOptions</span><span class="p">(</span><span class="n">depends_on</span><span class="o">=</span><span class="p">[</span><span class="n">vpc</span><span class="p">]),</span>
        <span class="o">**</span><span class="n">sg_config</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">sg_name</span><span class="p">,</span> <span class="n">sg_config</span> <span class="ow">in</span> <span class="n">resources</span><span class="p">[</span><span class="s1">&#39;tb:network:SecurityGroupWithRules&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="handling-secrets">
<h2>Handling Secrets<a class="headerlink" href="#handling-secrets" title="Link to this heading">¶</a></h2>
<p>Applications often need to operate on values such as database passwords that are considered secrets. You never want to
store these values in plaintext, since that is a security risk, and they should always be protected by policies
preventing unauthorized access.</p>
<p>To some extent, this problem is partially solved by Pulumi itself, which allows you to store secret values directly in
its configuration using hashes only decryptable with a secret passphrase.</p>
<p>To set a Pulumi secret value, make sure you have the right encryption passphrase exported and run a <code class="docutils literal notranslate"><span class="pre">pulumi</span> <span class="pre">config</span></code>
statement like so:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">PULUMI_CONFIG_PASSPHRASE</span><span class="o">=</span><span class="s1">&#39;a-super-secret-passphrase&#39;</span>
pulumi<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>--secret<span class="w"> </span>my-password<span class="w"> </span><span class="s1">&#39;P@$sw0rd&#39;</span>
</pre></div>
</div>
<p>This will add an item to your <code class="docutils literal notranslate"><span class="pre">Pulumi.$STACK_NAME.yaml</span></code> file in which this secret is listed in encrypted form. This is
considered secure because the data cannot be decrypted without the secret passphrase, which you should always keep
secret and secure.</p>
<p>But many AWS configurations will require that secret values come out of their Secrets Manager product. ECS Task
Definitions, for example, take in Secrets Manager ARNs to feed secret data into environment variables. To help bridge
the gap between Pulumi and AWS, we have the <a class="reference internal" href="secrets.html#tb_pulumi.secrets.PulumiSecretsManager" title="tb_pulumi.secrets.PulumiSecretsManager"><code class="xref py py-class docutils literal notranslate"><span class="pre">tb_pulumi.secrets.PulumiSecretsManager</span></code></a> class. Feed this a list
of <code class="docutils literal notranslate"><span class="pre">secret_names</span></code> which match Pulumi secret names. This module will create AWS secrets matching those Pulumi secrets.</p>
<p>For example, if we’ve run the above <code class="docutils literal notranslate"><span class="pre">pulumi</span> <span class="pre">config</span></code> command, we could add a section to our YAML config that looks like
this:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nn">---</span>
<span class="nt">resources</span><span class="p">:</span>
<span class="c1"># ...</span>
<span class="w">  </span><span class="nt">tb:secrets:PulumiSecretsManager</span><span class="p">:</span>
<span class="w">    </span><span class="nt">secrets</span><span class="p">:</span>
<span class="w">      </span><span class="nt">secret_names</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-password</span>
</pre></div>
</div>
<p>And later, we could add the following code to our tb_pulumi program:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">psm_opts</span> <span class="o">=</span> <span class="n">resources</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;tb:secrets:PulumiSecretsManager&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;secrets&#39;</span><span class="p">)</span>
<span class="n">psm</span> <span class="o">=</span> <span class="n">tb_pulumi</span><span class="o">.</span><span class="n">secrets</span><span class="o">.</span><span class="n">PulumiSecretsManager</span><span class="p">(</span>
  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;my-secrets&#39;</span><span class="p">,</span>
  <span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">,</span>
  <span class="o">**</span><span class="n">psm_opts</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This would ultimately create a series of Secrets Manager entries named after the listed secrets. Using this pattern
makes sure that your secret data stays secret the whole way through to the cloud provider.</p>
</section>
<section id="acting-on-fully-applied-pulumi-stacks">
<span id="full-stack-patterns"></span><h2>Acting on Fully Applied Pulumi Stacks<a class="headerlink" href="#acting-on-fully-applied-pulumi-stacks" title="Link to this heading">¶</a></h2>
<p>One limitation of raw Pulumi code is that the programmatic visibility into resources you have defined stops at the
individual resource level. ComponentResources give you no ability to inspect those components. As shown in previous
examples, the ThunderbirdComponentResource restores that ability.</p>
<p>As we have also shown, the outputs generated by these Resources and ComponentResources must be applied before you can
access their actual values. This can create some complexity where, for example, you may define a
ThunderbirdComponentResource that contains other ThunderbirdComponentResources. To access the resources of the inner
nested ThunderbirdComponentResource, you have to do a nested apply lambda. Your code gets very confusing at this point,
and hard to follow and debug.</p>
<p>Furthermore, if you need to create something like CloudWatch alarms for your resources, this leaves you defining those
alarms individually. If you add a new resource you want to monitor, you would have to write that code, or develop some
other module to set the monitors up.</p>
<p>Wouldn’t it be great if you could develop Pulumi code that simply acts on all resources in a project with full context
about those resources? Then you could write any kind of stack-aware meta-tool you like and act on the entire stack at
once.</p>
<p>Fortunately, tb_pulumi solves this problem as well. There is an abstract class called
<a class="reference internal" href="tb_pulumi.html#tb_pulumi.ProjectResourceGroup" title="tb_pulumi.ProjectResourceGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">tb_pulumi.ProjectResourceGroup</span></code></a> which can be extended, its <a class="reference internal" href="tb_pulumi.html#tb_pulumi.ProjectResourceGroup.ready" title="tb_pulumi.ProjectResourceGroup.ready"><code class="xref py py-meth docutils literal notranslate"><span class="pre">tb_pulumi.ProjectResourceGroup.ready()</span></code></a>
function implemented to act in just such a fully resolved state. This function (with a little help from
<a class="reference internal" href="tb_pulumi.html#tb_pulumi.ThunderbirdPulumiProject.flatten" title="tb_pulumi.ThunderbirdPulumiProject.flatten"><code class="xref py py-meth docutils literal notranslate"><span class="pre">tb_pulumi.ThunderbirdPulumiProject.flatten()</span></code></a>) recursively detects all outputs in a stack and resolves them,
calling that <code class="docutils literal notranslate"><span class="pre">ready</span></code> function only when everything is completely resolved and available.</p>
<p>For more information on developing ProjectResourceGroups, see <a class="reference internal" href="development.html#development"><span class="std std-ref">Development</span></a>. Currently, we have two specific
implementations.</p>
<p>This first pertains to monitoring. That is described fully on the <a class="reference internal" href="monitors.html#monitoring-resources"><span class="std std-ref">Monitoring Resources</span></a> page. The other is related
to granting access to your AWS resources with <a class="reference internal" href="iam.html#tb_pulumi.iam.StackAccessPolicies" title="tb_pulumi.iam.StackAccessPolicies"><code class="xref py py-class docutils literal notranslate"><span class="pre">tb_pulumi.iam.StackAccessPolicies</span></code></a>.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="monitors.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Monitoring Resources</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="getting-started.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Getting Started</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Thunderbird
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Patterns of Use</a><ul>
<li><a class="reference internal" href="#patterns-for-managing-projects">Patterns for Managing Projects</a></li>
<li><a class="reference internal" href="#resource-patterns">Resource Patterns</a><ul>
<li><a class="reference internal" href="#define-a-resource-with-no-dependencies">Define a resource with no dependencies</a></li>
<li><a class="reference internal" href="#access-a-resource-from-within-a-thunderbirdcomponentresource">Access a resource from within a ThunderbirdComponentResource</a></li>
<li><a class="reference internal" href="#defining-multiple-resources-of-the-same-type">Defining multiple resources of the same type</a></li>
</ul>
</li>
<li><a class="reference internal" href="#handling-secrets">Handling Secrets</a></li>
<li><a class="reference internal" href="#acting-on-fully-applied-pulumi-stacks">Acting on Fully Applied Pulumi Stacks</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=fd6eb6e6"></script>
    <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>